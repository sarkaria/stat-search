{"paragraphs":[{"text":"%md\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics</h3>\n<h4></h4>\n<b>Business Case</b></br>\n\nSTAT spiders and parses HTML search engine results for ~18 million keywords everyday. The parsing process transforms these HTML documents into ~1.8 billion result rows, with ~100 results per keyword. This leaves us with ~54 billion rows per month to analyze. One of our major objectives this year is improve both the storage and analysis of this parsed data so that we can quickly analyze our data across multiple dimensions in order to surface timely, actionable insights for our customers.</br>\n\nWe would like you to take a subset of our data, store it in an appropriate format, and then perform some analysis on the stored data.</br></br>\n\n<b>Data</b></br>\n\nYou can download a compressed CSV with a very tiny subset of our parsed data from https://stat-ds-test.s3.amazonaws.com/getstat_com_serp_report_201707.csv.gz - 3128 keywords for 31 days of July 2017 (approximately 9.9 million rows)\n\nThe parsed data can be divided into 2 parts - keyword information (entity data) and ranking metrics. The keyword information (entity data) is represented by the following columns</br>\nKeyword</br>\nMarket</br>\nLocation</br>\nDevice</br>\nThe date of the crawl (spider and parse) is represented by the “Crawl Date”</br>\nThe ranking metrics are represented by the following columns</br>\nRank</br>\nURL</br>\nEach combination of keyword information and crawl date will have approximately 100 ranks and URLs (lower ranks are better)</br></br>\n\n<b>Project</b></br>\n\nOur goal with the project is two fold:</br>\nDesign and build an ETL process to ingest and store this data in an efficient format for analysis\nAnalyze the data to answer three important SEO questions\nIn doing so, we want to give you a feel for the kind of work you will be doing in the Data Services team at STAT, and we want to get an idea of how you would solve these problems.\n\nAlthough we have provided a very tiny subset of data to you to limit the size and scope of the project, we would like you to design the solution considering the scale of data that we store and analyze in production today.</br>\n\nThe SEO questions that we would like you to answer are:</br>\n\n1. Which URL has the most ranks below 10 across all keywords over the period?</br>\n2. Provide the set of keywords (keyword information) where the rank 1 URL changes the most over the period. A change, for the purpose of this question, is when a given keyword's rank 1 URL is different from the previous day's URL.</br>\n3. We would like to understand how similar the results returned for the same keyword, market, and location are across devices. For the set of keywords, markets, and locations that have data for both desktop and smartphone devices, please devise a measure of difference to indicate how similar these datasets are.</br></br>\n\n<b>Deliverables</b></br>\n\nPlease submit your work in the form of a git repository, preferably a public repository on GitHub so we can easily share it among our team members. This repository should include:</br>\n1. A README.md file that outlines</br>\n2. How to install the required dependencies on a Linux or macOS system, and how to run the ETL and analysis process(es).</br>\n3. The process you went through to arrive at this solution.</br>\nNotes on any functionality you would have included before releasing the code into a production environment but were unable to due to time constraints.\nRunnable code that extracts the provided data and completes the requested analysis in the language of your choice.</br></br>\n\n<b>Some additional notes</b></br>\n\nPlease be mindful of the characteristics of solution that you choose, we'll be most interested in why you selected a particular solution given our parameters, and the trade offs of that solution relative to other options.</br>\n\nWe expect this assignment to take six hours or less. Please aim to produce code that you would be happy to release into a production environment, and document anything you would otherwise include but are unable to due to time constraints.</br>\n\n</div>\n\n<div class=\"clearfix\" style=\"padding: 10px; padding-left: 0px\">\n<a href=\"https://getstat.com\"><img src=\"https://getstat.com/drive/uploads/2012/08/STAT_logo_blue_small.jpg\" width=\"150px\" class=\"pull-left\" style=\"display: inline-block; margin: 0px;\"></a>\n</div>","user":"anonymous","dateUpdated":"2017-09-03T11:11:20-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics</h3>\n<h4></h4>\n<b>Business Case</b></br>\n\nSTAT spiders and parses HTML search engine results for ~18 million keywords everyday. The parsing process transforms these HTML documents into ~1.8 billion result rows, with ~100 results per keyword. This leaves us with ~54 billion rows per month to analyze. One of our major objectives this year is improve both the storage and analysis of this parsed data so that we can quickly analyze our data across multiple dimensions in order to surface timely, actionable insights for our customers.</br>\n\nWe would like you to take a subset of our data, store it in an appropriate format, and then perform some analysis on the stored data.</br></br>\n\n<b>Data</b></br>\n\nYou can download a compressed CSV with a very tiny subset of our parsed data from https://stat-ds-test.s3.amazonaws.com/getstat_com_serp_report_201707.csv.gz - 3128 keywords for 31 days of July 2017 (approximately 9.9 million rows)\n\nThe parsed data can be divided into 2 parts - keyword information (entity data) and ranking metrics. The keyword information (entity data) is represented by the following columns</br>\nKeyword</br>\nMarket</br>\nLocation</br>\nDevice</br>\nThe date of the crawl (spider and parse) is represented by the “Crawl Date”</br>\nThe ranking metrics are represented by the following columns</br>\nRank</br>\nURL</br>\nEach combination of keyword information and crawl date will have approximately 100 ranks and URLs (lower ranks are better)</br></br>\n\n<b>Project</b></br>\n\nOur goal with the project is two fold:</br>\nDesign and build an ETL process to ingest and store this data in an efficient format for analysis\nAnalyze the data to answer three important SEO questions\nIn doing so, we want to give you a feel for the kind of work you will be doing in the Data Services team at STAT, and we want to get an idea of how you would solve these problems.\n\nAlthough we have provided a very tiny subset of data to you to limit the size and scope of the project, we would like you to design the solution considering the scale of data that we store and analyze in production today.</br>\n\nThe SEO questions that we would like you to answer are:</br>\n\n1. Which URL has the most ranks below 10 across all keywords over the period?</br>\n2. Provide the set of keywords (keyword information) where the rank 1 URL changes the most over the period. A change, for the purpose of this question, is when a given keyword's rank 1 URL is different from the previous day's URL.</br>\n3. We would like to understand how similar the results returned for the same keyword, market, and location are across devices. For the set of keywords, markets, and locations that have data for both desktop and smartphone devices, please devise a measure of difference to indicate how similar these datasets are.</br></br>\n\n<b>Deliverables</b></br>\n\nPlease submit your work in the form of a git repository, preferably a public repository on GitHub so we can easily share it among our team members. This repository should include:</br>\n1. A README.md file that outlines</br>\n2. How to install the required dependencies on a Linux or macOS system, and how to run the ETL and analysis process(es).</br>\n3. The process you went through to arrive at this solution.</br>\nNotes on any functionality you would have included before releasing the code into a production environment but were unable to due to time constraints.\nRunnable code that extracts the provided data and completes the requested analysis in the language of your choice.</br></br>\n\n<b>Some additional notes</b></br>\n\nPlease be mindful of the characteristics of solution that you choose, we'll be most interested in why you selected a particular solution given our parameters, and the trade offs of that solution relative to other options.</br>\n\nWe expect this assignment to take six hours or less. Please aim to produce code that you would be happy to release into a production environment, and document anything you would otherwise include but are unable to due to time constraints.</br>\n\n</div>\n<div class=\"clearfix\" style=\"padding: 10px; padding-left: 0px\">\n<a href=\"https://getstat.com\"><img src=\"https://getstat.com/drive/uploads/2012/08/STAT_logo_blue_small.jpg\" width=\"150px\" class=\"pull-left\" style=\"display: inline-block; margin: 0px;\"></a>\n</div>\n</div>"}]},"apps":[],"jobName":"paragraph_1504459697586_165885654","id":"20170903-102817_2130175749","dateCreated":"2017-09-03T10:28:17-0700","dateStarted":"2017-09-03T11:11:20-0700","dateFinished":"2017-09-03T11:11:26-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8577"},{"title":"Verify Spark Version","text":"sc.version\n","user":"anonymous","dateUpdated":"2017-09-03T11:11:40-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres0: String = 2.1.0\n"}]},"apps":[],"jobName":"paragraph_1504326066920_185615845","id":"20170901-212106_1439781607","dateCreated":"2017-09-01T21:21:06-0700","dateStarted":"2017-09-03T11:11:41-0700","dateFinished":"2017-09-03T11:12:52-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8578"},{"title":"Load Data into Spark","text":"val df = sqlContext.read\n    .format(\"com.databricks.spark.csv\")\n    .option(\"header\", \"true\") // Use first line of all files as header\n    .option(\"inferSchema\", \"true\") // Automatically infer data types\n    .load(\"/Users/sarbjit/Desktop/Not backed up/getstat_com_serp_report_201707.csv\")\n    .cache","user":"anonymous","dateUpdated":"2017-09-03T11:13:16-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Keyword: string, Market: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1504324340282_-830756644","id":"20170901-205220_1693849834","dateCreated":"2017-09-01T20:52:20-0700","dateStarted":"2017-09-03T11:13:16-0700","dateFinished":"2017-09-03T11:16:02-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8579"},{"title":"Lets Look at a Sample of the Data","text":"// We note that the Location column is null for the entire data set.\ndf.printSchema\ndf.show(5)","user":"anonymous","dateUpdated":"2017-09-03T11:13:24-0700","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":362,"optionOpen":false}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Keyword: string (nullable = true)\n |-- Market: string (nullable = true)\n |-- Location: string (nullable = true)\n |-- Device: string (nullable = true)\n |-- Crawl Date: timestamp (nullable = true)\n |-- Rank: integer (nullable = true)\n |-- URL: string (nullable = true)\n\n+----------------+------+--------+-------+--------------------+----+--------------------+\n|         Keyword|Market|Location| Device|          Crawl Date|Rank|                 URL|\n+----------------+------+--------+-------+--------------------+----+--------------------+\n|search analytics| US-en|    null|desktop|2017-07-01 00:00:...|   1|support.google.co...|\n|search analytics| US-en|    null|desktop|2017-07-01 00:00:...|   2|  trends.google.com/|\n|search analytics| US-en|    null|desktop|2017-07-01 00:00:...|   3|developers.google...|\n|search analytics| US-en|    null|desktop|2017-07-01 00:00:...|   4|en.wikipedia.org/...|\n|search analytics| US-en|    null|desktop|2017-07-01 00:00:...|   5|searchengineland....|\n+----------------+------+--------+-------+--------------------+----+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1504455059800_927685784","id":"20170903-091059_792224568","dateCreated":"2017-09-03T09:10:59-0700","dateStarted":"2017-09-03T11:13:25-0700","dateFinished":"2017-09-03T11:17:02-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8580"},{"text":"%md\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics Q1</h3>\nHere we simply filter the data by rank and \n</div>","user":"anonymous","dateUpdated":"2017-09-03T11:13:44-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics Q1</h3>\nHere we simply filter the data by rank and \n</div>\n</div>"}]},"apps":[],"jobName":"paragraph_1504460883138_-994202323","id":"20170903-104803_2105147452","dateCreated":"2017-09-03T10:48:03-0700","dateStarted":"2017-09-03T11:13:44-0700","dateFinished":"2017-09-03T11:13:44-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8581"},{"title":"1. Top 20 URLs with the most ranks below 10 across all keywords","text":"val df1 = df.filter($\"Rank\" < 10)\n    .groupBy(\"URL\")\n    .agg(count($\"URL\") as \"count\")\n    .sort($\"count\".desc)\n    \nz.show(df1.limit(20))","user":"anonymous","dateUpdated":"2017-09-03T11:13:47-0700","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":366,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf1: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [URL: string, count: bigint]\n"},{"type":"TABLE","data":"URL\tcount\nserps.com/tools/rank-checker/\t22612\nmoz.com/tools/rank-tracker\t21780\nwww.rankscanner.com/\t14356\nranktrackr.com/\t14059\nwww.shoutmeloud.com/5-excellent-websites-to-check-keyword-ranking-in-google.html\t11318\nwww.google.com/\t11177\nwww.google.co.uk/\t9853\nwww.link-assistant.com/rank-tracker/\t8539\nproranktracker.com/\t8529\nserps.com/\t8023\nwww.semrush.com/features/position-tracking/\t6890\nahrefs.com/rank-tracker\t6313\nsmallseotools.com/keyword-position/\t5641\nserpbook.com/\t5457\ngetstat.com/\t5148\nsmartserp.com/\t4450\nwww.ranktracker.com/\t4341\nwww.serplab.co.uk/\t4335\nwww.whatsmyserp.com/serpcheck.php\t4287\nwww.rankwatch.com/\t4268\n"}]},"apps":[],"jobName":"paragraph_1504324864924_-528778019","id":"20170901-210104_1353211701","dateCreated":"2017-09-01T21:01:04-0700","dateStarted":"2017-09-03T11:16:03-0700","dateFinished":"2017-09-03T11:19:53-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8582"},{"text":"%md\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics Q2</h3>\n</div>","user":"anonymous","dateUpdated":"2017-09-03T11:13:51-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics Q2</h3>\n</div>\n</div>"}]},"apps":[],"jobName":"paragraph_1504460980266_-773451688","id":"20170903-104940_1391865830","dateCreated":"2017-09-03T10:49:40-0700","dateStarted":"2017-09-03T11:13:51-0700","dateFinished":"2017-09-03T11:13:51-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8583"},{"title":"2a. Count number of days at Rank 1","text":"// Here what we do is to count the number of URLs for a given keyword that are ranked 1\n// We do this for a given market and device so that the best keyword would have in this\n// case just 1 URL over the 31 days and the most changeable would have 31 URLs.\n\nval df2a = df.filter($\"Rank\" === 1)\n    .filter($\"Market\" === \"US-en\")\n    .filter($\"Device\" === \"smartphone\")\n    .groupBy($\"Keyword\", $\"URL\").agg(count($\"URL\") as \"count_at_rank1\")\n    .sort($\"count_at_rank1\".asc)\n    .cache\n    \ndf2a.show()","user":"anonymous","dateUpdated":"2017-09-03T11:13:54-0700","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"Keyword","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"URL","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf2a: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Keyword: string, URL: string ... 1 more field]\n+--------------------+--------------------+--------------+\n|             Keyword|                 URL|count_at_rank1|\n+--------------------+--------------------+--------------+\n|       google update|m.gadgets.ndtv.co...|             1|\n|website ranking tool|serps.com/tools/r...|             1|\n|what is a people ...|mashable.com/2015...|             1|\n|       google update|www.washingtonpos...|             1|\n|enterprise serp a...|getstat.com/take-...|             1|\n|organic click thr...|     www.google.com/|             1|\n|       google update|phandroid.com/201...|             1|\n|       google update|www.express.co.uk...|             1|\n|       google update|www.searchenginej...|             1|\n| google answer boxes|searchengineland....|             1|\n|       google update|www.xda-developer...|             1|\n|       google update|m.gsmarena.com/pl...|             1|\n|       google update|9to5google.com/20...|             1|\n|smartphone keywor...|www.workshopdigit...|             1|\n|       google update|www.androidheadli...|             1|\n|       search funnel|twitter.com/elisa...|             1|\n|optimizing for in...|seocopywriting.co...|             1|\n|       google update|www.theverge.com/...|             1|\n|                 ctr|en.wikipedia.org/...|             1|\n| personalized search|en.m.wikipedia.or...|             1|\n+--------------------+--------------------+--------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1504325635257_-180874190","id":"20170901-211355_1517773168","dateCreated":"2017-09-01T21:13:55-0700","dateStarted":"2017-09-03T11:17:02-0700","dateFinished":"2017-09-03T11:20:02-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8584"},{"title":"2b. Top 20 Keywords that are the most changeable","text":"// Now we compute te most changeable keywords.\n// We do this by grouping and counting the keywords appearing in the Keyword column of the previous result.\n\nval df2b = df2a.groupBy($\"Keyword\").agg(count($\"Keyword\") as \"count\").sort($\"count\".desc)\nz.show(df2b.limit(20))","user":"anonymous","dateUpdated":"2017-09-03T11:13:59-0700","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf2b: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Keyword: string, count: bigint]\n"},{"type":"TABLE","data":"Keyword\tcount\ngoogle update\t32\nsmartphone keyword tracking\t6\nhow much does stat cost\t5\nsegmentation and seo\t5\nhow to do rank tracking for smartphones\t5\nwhat is a paa\t5\ngoogle answers boxes\t4\nbest way to track keywords\t4\nmobile seo\t4\nseo ranking\t4\nmobile ranking\t4\nlocal search strategies\t4\ngoogle serp tracking\t4\nlocal seo\t4\nfeatured snippet format\t4\ngoogle algorithms\t4\noptimizing for intent\t4\nwhat does voices search mean for seo\t3\ntracking keywords for seo\t3\nseo funnel\t3\n"}]},"apps":[],"jobName":"paragraph_1504458357883_-686652202","id":"20170903-100557_709686274","dateCreated":"2017-09-03T10:05:57-0700","dateStarted":"2017-09-03T11:19:54-0700","dateFinished":"2017-09-03T11:20:05-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8585"},{"text":"%md\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics Q3</h3>\n</div>","user":"anonymous","dateUpdated":"2017-09-03T10:55:13-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<div class=\"alert alert-warning\" role=\"alert\" style=\"margin: 10px\">\n<h3>Stat Search Analytics Q3</h3>\n</div>\n</div>"}]},"apps":[],"jobName":"paragraph_1504460996278_-2095448909","id":"20170903-104956_151682521","dateCreated":"2017-09-03T10:49:56-0700","dateStarted":"2017-09-03T10:50:06-0700","dateFinished":"2017-09-03T10:50:06-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8586"},{"title":"3. Market breakdown for Mobile access","text":"val mobDf = df.filter($\"Device\" === \"smartphone\").groupBy($\"Market\").agg(count($\"Market\"))\nz.show(mobDf)","user":"anonymous","dateUpdated":"2017-09-03T11:14:03-0700","config":{"colWidth":6,"enabled":true,"results":{"1":{"graph":{"mode":"pieChart","height":298,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nmobDf: org.apache.spark.sql.DataFrame = [Market: string, count(Market): bigint]\n"},{"type":"TABLE","data":"Market\tcount(Market)\nCA-en\t449762\nUS-en\t615867\nGB-en\t489570\n"}]},"apps":[],"jobName":"paragraph_1504329609945_-459875976","id":"20170901-222009_1100515003","dateCreated":"2017-09-01T22:20:09-0700","dateStarted":"2017-09-03T11:20:02-0700","dateFinished":"2017-09-03T11:20:09-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8587"},{"title":"3. Market breakdown for Desktop access","text":"val dtDf = df.filter($\"Device\" === \"desktop\").groupBy($\"Market\").agg(count($\"Market\"))\nz.show(dtDf)","user":"anonymous","dateUpdated":"2017-09-03T13:17:31-0700","config":{"colWidth":6,"enabled":true,"results":{"1":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndtDf: org.apache.spark.sql.DataFrame = [Market: string, count(Market): bigint]\n"},{"type":"TABLE","data":"Market\tcount(Market)\nCA-en\t442774\nUS-en\t3991700\nGB-en\t3911365\n"}]},"apps":[],"jobName":"paragraph_1504456323692_1877434893","id":"20170903-093203_1275990522","dateCreated":"2017-09-03T09:32:03-0700","dateStarted":"2017-09-03T13:17:31-0700","dateFinished":"2017-09-03T13:17:36-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8588"},{"title":"3. Top 10 Keywords for Mobile Access","text":"val mobDf = df.filter($\"Device\" === \"smartphone\").groupBy($\"Keyword\").agg(count($\"Keyword\") as \"count\").sort($\"count\".desc).limit(10)\nz.show(mobDf)","user":"anonymous","dateUpdated":"2017-09-03T11:14:09-0700","config":{"colWidth":6,"enabled":true,"results":{"1":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nmobDf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Keyword: string, count: bigint]\n"},{"type":"TABLE","data":"Keyword\tcount\ngoogle update\t10196\nvoice search\t9890\nwhat does voices search mean for seo\t9846\npersonalized search\t9706\npaa\t9668\nwhat is a paa\t9641\ngoogle algorithms\t9637\ngoogle answer boxes\t9561\ngoogle answer box\t9537\nseo competitors\t9523\n"}]},"apps":[],"jobName":"paragraph_1504455699065_1806924032","id":"20170903-092139_1763875013","dateCreated":"2017-09-03T09:21:39-0700","dateStarted":"2017-09-03T11:20:10-0700","dateFinished":"2017-09-03T11:20:19-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8589"},{"title":"Top 10 Keywords for Desktop Access","text":"val dtDf = df.filter($\"Device\" === \"desktop\").groupBy($\"Keyword\").agg(count($\"Keyword\") as \"count\").sort($\"count\".desc).limit(10)\n\nz.show(dtDf)","user":"anonymous","dateUpdated":"2017-09-03T11:14:11-0700","config":{"colWidth":6,"enabled":true,"results":{"1":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndtDf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Keyword: string, count: bigint]\n"},{"type":"TABLE","data":"Keyword\tcount\ngoogle algorithms\t9626\ngoogle update\t9585\ngoogle answer box\t9498\ncompetitive landscape\t9496\ngoogle answer boxes\t9488\noptimize for conversion\t9486\nwhat does ctr stand for\t9486\nseo keywords\t9484\nseo competitors\t9478\nseo strategies\t9474\n"}]},"apps":[],"jobName":"paragraph_1504456559649_-288379607","id":"20170903-093559_376949793","dateCreated":"2017-09-03T09:35:59-0700","dateStarted":"2017-09-03T11:20:16-0700","dateFinished":"2017-09-03T11:20:24-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8590"},{"text":"","user":"anonymous","dateUpdated":"2017-09-03T09:38:17-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1504326867869_1901144960","id":"20170901-213427_444581716","dateCreated":"2017-09-01T21:34:27-0700","dateStarted":"2017-09-03T09:19:20-0700","dateFinished":"2017-09-03T09:19:26-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8591"}],"name":"stat-search assignment","id":"2CSWFJW5U","angularObjects":{"2CJFTQHZ4:shared_process":[],"2CEUS9DKM:shared_process":[],"2CFFFDCER:shared_process":[],"2CEGZPJT2:shared_process":[],"2CG74DNN1:shared_process":[],"2CF8F6KBU:shared_process":[],"2CEUW6C7J:shared_process":[],"2CGA351E2:shared_process":[],"2CGZHT8TG:shared_process":[],"2CHU7A7Y4:shared_process":[],"2CFP8F79Y:shared_process":[],"2CJ438FVX:shared_process":[],"2CHDXD6WZ:shared_process":[],"2CJE9PS6N:shared_process":[],"2CGXNSCD4:shared_process":[],"2CG1P1D68:shared_process":[],"2CG11WSPH:shared_process":[],"2CHBHWQD8:shared_process":[],"2CH1NQ1RG:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}